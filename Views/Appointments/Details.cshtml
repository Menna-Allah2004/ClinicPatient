@model ClinicPatient.ViewModels.AppointmentViewModel

@{
    ViewData["Title"] = "تفاصيل الموعد";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

    <!-- Main Content -->
    <main class="py-5">
        <div class="container">
            <div class="row mb-4">
                <div class="col-12">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">الرئيسية</a></li>
                        <li class="breadcrumb-item"><a asp-controller="Appointments" asp-action="Index">مواعيدي</a></li>
                            <li class="breadcrumb-item active" aria-current="page">تفاصيل الموعد</li>
                        </ol>
                    </nav>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <div class="card border-0 shadow-sm rounded-3 overflow-hidden">
                        <div class="card-header bg-medical-600 text-white py-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <h1 class="h4 mb-0">تفاصيل الموعد</h1>
                                <span class="badge bg-medical-800 fs-6">معتمد</span>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <div class="row mb-4">
                                <div class="col-md-6 mb-3 mb-md-0">
                                    <div class="d-flex align-items-center">
                                    <img src="@Html.DisplayFor(model => model.DoctorImageUrl)" alt="الدكتور"
                                            class="rounded-circle border border-2 border-medical-100 me-3" width="60"
                                            height="60">
                                        <div>
                                        <h3 class="h5 mb-1" id="doctorName">@Html.DisplayNameFor(model => model.DoctorName)</h3>
                                        <p class="text-muted mb-0" id="doctorSpecialty">@Html.DisplayNameFor(model => model.DoctorSpecialization)</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="d-flex h-100 align-items-center justify-content-md-end">
                                        <div class="text-end">
                                            <div class="d-flex align-items-center justify-content-end mb-2">
                                                <div class="me-2">
                                                    <p class="fw-medium mb-0" id="appointmentDate">الأربعاء، 12 أبريل
                                                        2023</p>
                                                    <p class="text-muted mb-0" id="appointmentTime">10:30 صباحاً</p>
                                                </div>
                                                <div class="bg-medical-50 rounded-circle p-2">
                                                    <i class="fas fa-calendar-alt text-medical-600 fa-fw"></i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <hr class="text-muted my-4">

                            <div class="row g-4">
                                <div class="col-md-6">
                                    <h4 class="h6 text-muted mb-3">معلومات الموعد</h4>
                                    <div class="mb-3">
                                        <div class="d-flex mb-2">
                                            <div class="min-w-20 text-muted">
                                                <i class="fas fa-clinic-medical me-2"></i>
                                            </div>
                                            <div>
                                                <p class="mb-0 fw-medium">نوع الزيارة</p>
                                                <p class="text-muted mb-0" id="visitType">عيادة خارجية</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="d-flex mb-2">
                                            <div class="min-w-20 text-muted">
                                                <i class="fas fa-map-marker-alt me-2"></i>
                                            </div>
                                            <div>
                                                <p class="mb-0 fw-medium">الموقع</p>
                                                <p class="text-muted mb-0" id="location">
                                                    مركز طبي - الطابق الثاني - غرفة 204
                                                    </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="d-flex mb-2">
                                            <div class="min-w-20 text-muted">
                                                <i class="fas fa-credit-card me-2"></i>
                                            </div>
                                            <div>
                                                <p class="mb-0 fw-medium">رسوم الاستشارة</p>
                                                <p class="text-muted mb-0" id="consultationFee">20 شيكل</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <h4 class="h6 text-muted mb-3">معلومات إضافية</h4>
                                    <div class="mb-3">
                                        <div class="d-flex mb-2">
                                            <div class="min-w-20 text-muted">
                                                <i class="fas fa-clipboard-list me-2"></i>
                                            </div>
                                            <div>
                                                <p class="mb-0 fw-medium">سبب الزيارة</p>
                                                <p class="text-muted mb-0" id="visitReason">
                                                    استشارة دورية لمتابعة حالة الضغط
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="d-flex mb-2">
                                            <div class="min-w-20 text-muted">
                                                <i class="fas fa-notes-medical me-2"></i>
                                            </div>
                                            <div>
                                                <p class="mb-0 fw-medium">ملاحظات طبية</p>
                                                <p class="text-muted mb-0" id="medicalNotes">
                                                    إحضار نتائج فحص الدم الأخيرة وقراءات ضغط الدم الأسبوعية
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="d-flex mb-2">
                                            <div class="min-w-20 text-muted">
                                                <i class="fas fa-id-card me-2"></i>
                                            </div>
                                            <div>
                                                <p class="mb-0 fw-medium">رقم الموعد</p>
                                                <p class="text-muted mb-0" id="appointmentNumber">APT-20250412-0025</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <hr class="text-muted my-4">

                            <div class="d-flex flex-column flex-md-row gap-3 justify-content-between">
                                <a href="add-to-calendar.html" class="btn btn-outline-primary">
                                    <i class="fas fa-calendar-plus me-2"></i>
                                    إضافة إلى التقويم
                                </a>
                                <div class="d-flex gap-2">
                                    <button type="button" class="btn btn-outline-danger" id="cancelAppointmentBtn">
                                        <i class="fas fa-times-circle me-2"></i>
                                        إلغاء الموعد
                                    </button>
                                    <button type="button" class="btn btn-primary" id="rescheduleAppointmentBtn">
                                        <i class="fas fa-calendar-alt me-2"></i>
                                        إعادة جدولة
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card border-0 shadow-sm rounded-3 overflow-hidden mt-4">
                        <div class="card-body p-4">
                            <h4 class="h5 mb-3">هل تحتاج إلى مساعدة؟</h4>
                            <p class="text-muted mb-4">يمكنك التواصل مع فريق الدعم الخاص بنا للمساعدة فيما يتعلق بموعدك.
                            </p>
                            <div class="d-flex flex-column flex-md-row gap-3">
                                <a href="tel:+972567000000" class="btn btn-outline-primary">
                                    <i class="fas fa-phone-alt me-2"></i>
                                    اتصال
                                </a>
                                <a href="mailto:mennaallah102004@gmail.com" class="btn btn-outline-primary">
                                    <i class="fas fa-envelope me-2"></i>
                                    البريد الإلكتروني
                                </a>
                                <a href="#" class="btn btn-outline-primary">
                                    <i class="fas fa-comments me-2"></i>
                                    الدردشة المباشرة
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

        <!-- Cancel Appointment Modal -->
    <div class="modal fade" id="cancelAppointmentModal" tabindex="-1" aria-labelledby="cancelAppointmentModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cancelAppointmentModalLabel">تأكيد إلغاء الموعد</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-4">
                        <i class="fas fa-exclamation-triangle text-warning fa-3x mb-3"></i>
                        <h5>هل أنت متأكد من رغبتك في إلغاء هذا الموعد؟</h5>
                        <p class="text-muted">
                        سيتم إلغاء موعدك مع الدكتور <span id="cancelDoctorName">@Html.DisplayNameFor(model => model.DoctorName)</span> يوم
                            <span id="cancelAppointmentDay">الأربعاء، 12 أبريل 2023</span>. يرجى ملاحظة أن الإلغاء
                            قبل 24 ساعة من الموعد سيؤدي إلى استرداد كامل المبلغ.
                        </p>
                    </div>
                    <div class="mb-3">
                        <label for="cancellationReason" class="form-label">سبب الإلغاء</label>
                        <select class="form-select" id="cancellationReason" required>
                            <option value="" selected disabled>اختر سبب الإلغاء</option>
                            <option value="schedule_conflict">تعارض في المواعيد</option>
                            <option value="feeling_better">تحسن الحالة الصحية</option>
                            <option value="found_another_doctor">وجدت طبيب آخر</option>
                            <option value="emergency">ظروف طارئة</option>
                            <option value="other">سبب آخر</option>
                        </select>
                    </div>
                    <div class="mb-3" id="otherReasonContainer" style="display: none;">
                        <label for="otherReason" class="form-label">يرجى ذكر السبب</label>
                        <textarea class="form-control" id="otherReason" rows="3"
                            placeholder="اكتب سبب الإلغاء هنا..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إغلاق</button>
                    <button type="button" class="btn btn-danger" id="confirmCancelBtn">تأكيد الإلغاء</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reschedule Appointment Modal -->
    <div class="modal fade" id="rescheduleAppointmentModal" tabindex="-1"
        aria-labelledby="rescheduleAppointmentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="rescheduleAppointmentModalLabel">إعادة جدولة الموعد</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted mb-4">
                    يرجى اختيار تاريخ ووقت جديد لموعدك مع الدكتور <span id="rescheduleDoctorName">@Html.DisplayNameFor(model => model.DoctorName)</span>.
                    </p>
                    <div class="mb-3">
                        <label for="newAppointmentDate" class="form-label">تاريخ جديد</label>
                        <input type="date" class="form-control" id="newAppointmentDate" required min="">
                    </div>
                    <div class="mb-4">
                        <label class="form-label">وقت جديد</label>
                        <div class="d-flex flex-wrap gap-2" id="availableTimeSlots">
                            <div class="form-check appointment-time-radio">
                                <input class="form-check-input" type="radio" name="timeSlot" id="timeSlot1"
                                    value="09:00">
                                <label class="form-check-label px-3 py-2 rounded-3 border" for="timeSlot1">
                                    09:00 صباحاً
                                </label>
                            </div>
                            <div class="form-check appointment-time-radio">
                                <input class="form-check-input" type="radio" name="timeSlot" id="timeSlot2"
                                    value="09:30">
                                <label class="form-check-label px-3 py-2 rounded-3 border" for="timeSlot2">
                                    09:30 صباحاً
                                </label>
                            </div>
                            <div class="form-check appointment-time-radio">
                                <input class="form-check-input" type="radio" name="timeSlot" id="timeSlot3"
                                    value="10:00">
                                <label class="form-check-label px-3 py-2 rounded-3 border" for="timeSlot3">
                                    10:00 صباحاً
                                </label>
                            </div>
                            <div class="form-check appointment-time-radio">
                                <input class="form-check-input" type="radio" name="timeSlot" id="timeSlot4"
                                    value="10:30">
                                <label class="form-check-label px-3 py-2 rounded-3 border" for="timeSlot4">
                                    10:30 صباحاً
                                </label>
                            </div>
                            <div class="form-check appointment-time-radio">
                                <input class="form-check-input" type="radio" name="timeSlot" id="timeSlot5"
                                    value="11:00">
                                <label class="form-check-label px-3 py-2 rounded-3 border" for="timeSlot5">
                                    11:00 صباحاً
                                </label>
                            </div>
                            <div class="form-check appointment-time-radio">
                                <input class="form-check-input" type="radio" name="timeSlot" id="timeSlot6"
                                    value="11:30">
                                <label class="form-check-label px-3 py-2 rounded-3 border" for="timeSlot6">
                                    11:30 صباحاً
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="alert alert-info" role="alert">
                        <i class="fas fa-info-circle me-2"></i>
                        ملاحظة: يمكنك إعادة جدولة الموعد مرة واحدة فقط بدون رسوم إضافية.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary" id="confirmRescheduleBtn">تأكيد إعادة الجدولة</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="~/js/appointment-details.js"></script>
    <script src="~/js/common.js"></script>

<div>
    <a asp-action="Edit" asp-route-id="@Model?.Id">Edit</a> |
    <a asp-action="Index">Back to List</a>
</div>
